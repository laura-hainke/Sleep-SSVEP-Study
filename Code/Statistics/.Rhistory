panel.grid = element_blank(),
plot.title = element_text(size=rel(3)),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
spindles_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","Spindles_count_con","Spindles_amplitude_con","Spindles_frequency_con","Spindles_count_exp","Spindles_amplitude_exp","Spindles_frequency_exp")])
# Median SNR values per condition
medians_spindles = aggregate(value ~ variable * condition, spindles_long, median) # mean likely biased by outliers
ggplot(medians_spindles, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3)),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
SOs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","SOs_count_con","SOs_amplitude_con","SOs_frequency_con","SOs_count_exp","SOs_amplitude_exp","SOs_frequency_exp")])
# Median SNR values per condition
medians_SOs = aggregate(value ~ variable * condition, SOs_long, median) # mean likely biased by outliers
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3)),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
View(data_sleep_extra)
spindle_count_results = test_two_levels(data_sleep_extra$Spindles_count_exp, data_sleep_extra$Spindles_count_con, parametric=TRUE, alternative="two.sided", verbose=FALSE)
View(spindle_count_results)
round(spindle_count_results[[1]], 2)
SOs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","SOs_count_con","SOs_amplitude_con","SOs_frequency_con","SOs_count_exp","SOs_amplitude_exp","SOs_frequency_exp")])
# Median SNR values per condition
medians_SOs = aggregate(value ~ variable * condition, SOs_long, median) # mean likely biased by outliers
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3)),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
spindle_count_results = test_two_levels(data_sleep_extra$Spindles_count_exp, data_sleep_extra$Spindles_count_con, parametric=FALSE, alternative="two.sided", verbose=FALSE)
View(data_sleep_extra)
spindle_count_results = test_two_levels(data_sleep_extra$Spindles_count_exp, data_sleep_extra$Spindles_count_con, parametric=TRUE, alternative="two.sided", verbose=FALSE)
SO_count_results = test_two_levels(data_sleep_extra$SOs_count_exp, data_sleep_extra$SOs_count_con, parametric=TRUE, alternative="two.sided", verbose=FALSE)
round(SO_count_results[[1]], 2)
REMs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","REMs_count_con","REMs_amplitude_con","REMs_density_con","REMs_count_exp","REMs_amplitude_exp","REMs_density_exp")])
# Median SNR values per condition
medians_REMs = aggregate(value ~ variable * condition, REMs_long, median) # mean likely biased by outliers
ggplot(medians_REMs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Rapid-Eye Movements", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3)),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
REMs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","REMs_count_con","REMs_amplitude_con","REMs_density_con","REMs_count_exp","REMs_amplitude_exp","REMs_density_exp")])
# Median SNR values per condition
medians_REMs = aggregate(value ~ variable * condition, REMs_long, median) # mean likely biased by outliers
ggplot(medians_REMs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Rapid-Eye Movements", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=3),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
REMs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","REMs_count_con","REMs_amplitude_con","REMs_density_con","REMs_count_exp","REMs_amplitude_exp","REMs_density_exp")])
# Median SNR values per condition
medians_REMs = aggregate(value ~ variable * condition, REMs_long, median) # mean likely biased by outliers
ggplot(medians_REMs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Rapid-Eye Movements", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=6),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
REMs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","REMs_count_con","REMs_amplitude_con","REMs_density_con","REMs_count_exp","REMs_amplitude_exp","REMs_density_exp")])
# Median SNR values per condition
medians_REMs = aggregate(value ~ variable * condition, REMs_long, median) # mean likely biased by outliers
ggplot(medians_REMs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Rapid-Eye Movements", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=1),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
REMs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","REMs_count_con","REMs_amplitude_con","REMs_density_con","REMs_count_exp","REMs_amplitude_exp","REMs_density_exp")])
# Median SNR values per condition
medians_REMs = aggregate(value ~ variable * condition, REMs_long, median) # mean likely biased by outliers
ggplot(medians_REMs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Rapid-Eye Movements", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
REMs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","REMs_count_con","REMs_amplitude_con","REMs_density_con","REMs_count_exp","REMs_amplitude_exp","REMs_density_exp")])
# Median SNR values per condition
medians_REMs = aggregate(value ~ variable * condition, REMs_long, median) # mean likely biased by outliers
ggplot(medians_REMs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Rapid-Eye Movements", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.5),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
REMs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","REMs_count_con","REMs_amplitude_con","REMs_density_con","REMs_count_exp","REMs_amplitude_exp","REMs_density_exp")])
# Median SNR values per condition
medians_REMs = aggregate(value ~ variable * condition, REMs_long, median) # mean likely biased by outliers
ggplot(medians_REMs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Rapid-Eye Movements", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=-0.5),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
REMs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","REMs_count_con","REMs_amplitude_con","REMs_density_con","REMs_count_exp","REMs_amplitude_exp","REMs_density_exp")])
# Median SNR values per condition
medians_REMs = aggregate(value ~ variable * condition, REMs_long, median) # mean likely biased by outliers
ggplot(medians_REMs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Rapid-Eye Movements", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=-0.2),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
spindles_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","Spindles_count_con","Spindles_amplitude_con","Spindles_frequency_con","Spindles_count_exp","Spindles_amplitude_exp","Spindles_frequency_exp")])
# Median SNR values per condition
medians_spindles = aggregate(value ~ variable * condition, spindles_long, median) # mean likely biased by outliers
ggplot(medians_spindles, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Spindles", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=-0.2),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
spindles_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","Spindles_count_con","Spindles_amplitude_con","Spindles_frequency_con","Spindles_count_exp","Spindles_amplitude_exp","Spindles_frequency_exp")])
# Median SNR values per condition
medians_spindles = aggregate(value ~ variable * condition, spindles_long, median) # mean likely biased by outliers
ggplot(medians_spindles, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Spindles", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=-0.4),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
spindles_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","Spindles_count_con","Spindles_amplitude_con","Spindles_frequency_con","Spindles_count_exp","Spindles_amplitude_exp","Spindles_frequency_exp")])
# Median SNR values per condition
medians_spindles = aggregate(value ~ variable * condition, spindles_long, median) # mean likely biased by outliers
ggplot(medians_spindles, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Spindles", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.2),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
spindles_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","Spindles_count_con","Spindles_amplitude_con","Spindles_frequency_con","Spindles_count_exp","Spindles_amplitude_exp","Spindles_frequency_exp")])
# Median SNR values per condition
medians_spindles = aggregate(value ~ variable * condition, spindles_long, median) # mean likely biased by outliers
ggplot(medians_spindles, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Spindles", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.1),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
SOs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","SOs_count_con","SOs_amplitude_con","SOs_frequency_con","SOs_count_exp","SOs_amplitude_exp","SOs_frequency_exp")])
# Median SNR values per condition
medians_SOs = aggregate(value ~ variable * condition, SOs_long, median) # mean likely biased by outliers
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Slow Oscillations", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3)),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
SOs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","SOs_count_con","SOs_amplitude_con","SOs_frequency_con","SOs_count_exp","SOs_amplitude_exp","SOs_frequency_exp")])
# Median SNR values per condition
medians_SOs = aggregate(value ~ variable * condition, SOs_long, median) # mean likely biased by outliers
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Slow Oscillations", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=-0.1),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
SOs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","SOs_count_con","SOs_amplitude_con","SOs_frequency_con","SOs_count_exp","SOs_amplitude_exp","SOs_frequency_exp")])
# Median SNR values per condition
medians_SOs = aggregate(value ~ variable * condition, SOs_long, median) # mean likely biased by outliers
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Slow Oscillations", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=-0.2),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
SOs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","SOs_count_con","SOs_amplitude_con","SOs_frequency_con","SOs_count_exp","SOs_amplitude_exp","SOs_frequency_exp")])
# Median SNR values per condition
medians_SOs = aggregate(value ~ variable * condition, SOs_long, median) # mean likely biased by outliers
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Slow Oscillations", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=2),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
SOs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","SOs_count_con","SOs_amplitude_con","SOs_frequency_con","SOs_count_exp","SOs_amplitude_exp","SOs_frequency_exp")])
# Median SNR values per condition
medians_SOs = aggregate(value ~ variable * condition, SOs_long, median) # mean likely biased by outliers
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Slow Oscillations", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=1),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
SOs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","SOs_count_con","SOs_amplitude_con","SOs_frequency_con","SOs_count_exp","SOs_amplitude_exp","SOs_frequency_exp")])
# Median SNR values per condition
medians_SOs = aggregate(value ~ variable * condition, SOs_long, median) # mean likely biased by outliers
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Slow Oscillations", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.5),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
spindles_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","Spindles_count_con","Spindles_amplitude_con","Spindles_frequency_con","Spindles_count_exp","Spindles_amplitude_exp","Spindles_frequency_exp")])
# Median SNR values per condition
medians_spindles = aggregate(value ~ variable * condition, spindles_long, median) # mean likely biased by outliers
ggplot(medians_spindles, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Spindles", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.05),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
spindles_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","Spindles_count_con","Spindles_amplitude_con","Spindles_frequency_con","Spindles_count_exp","Spindles_amplitude_exp","Spindles_frequency_exp")])
# Median SNR values per condition
medians_spindles = aggregate(value ~ variable * condition, spindles_long, median) # mean likely biased by outliers
ggplot(medians_spindles, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Spindles", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.08),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
SOs_long = dataframe_wide_to_long(data_sleep_extra[,c("ID","SOs_count_con","SOs_amplitude_con","SOs_frequency_con","SOs_count_exp","SOs_amplitude_exp","SOs_frequency_exp")])
# Median SNR values per condition
medians_SOs = aggregate(value ~ variable * condition, SOs_long, median) # mean likely biased by outliers
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Slow Oscillations", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.6),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
# Conversion to long format
data_REM_lat_long = dataframe_wide_to_long(data_sleep[2:30,c("ID","REM_lat_con","REM_lat_exp")]) # excluding participant 1, NA
# Plot
ggplot(data_REM_lat_long, aes(x=condition, y=value)) +
geom_violinhalf(aes(fill=condition), flip=1) + # Violin plot shape
geom_point(color="grey", size=2) + # Data points, jittered
geom_line(aes(group = ID), color="grey", linewidth=0.5) + # connect paired dots
stat_summary(fun = "mean", geom="point", shape=18, color = "black", size=5) + # Add mean as point
labs(title="REM Sleep Latency", x="Condition", y="Latency in minutes") + # Labels
scale_fill_manual(values=c(colour_scheme$con, colour_scheme$exp), guide="none") + # Condition colours, remove legend
scale_x_discrete(labels=c("Control","Experimental")) + # X-tick labels
# scale_y_continuous(limits=c(315,460),breaks=c(320,390,460)) +
coord_fixed(ratio=0.015) +
theme_minimal(base_size=base_size) + # Background
theme(axis.title.x = element_text(size=rel(2), vjust=-1), # Label sizes, relative
axis.title.y = element_text(size=rel(2), vjust=2),
axis.text = element_text(size=rel(1.7)),
panel.grid.major.x = element_blank(),
plot.title = element_text(size=rel(3), hjust=2),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
# Conversion to long format
data_REM_lat_long = dataframe_wide_to_long(data_sleep[2:30,c("ID","REM_lat_con","REM_lat_exp")]) # excluding participant 1, NA
# Plot
ggplot(data_REM_lat_long, aes(x=condition, y=value)) +
geom_violinhalf(aes(fill=condition), flip=1) + # Violin plot shape
geom_point(color="grey", size=2) + # Data points, jittered
geom_line(aes(group = ID), color="grey", linewidth=0.5) + # connect paired dots
stat_summary(fun = "mean", geom="point", shape=18, color = "black", size=5) + # Add mean as point
labs(title="REM Sleep Latency", x="Condition", y="Minutes") + # Labels
scale_fill_manual(values=c(colour_scheme$con, colour_scheme$exp), guide="none") + # Condition colours, remove legend
scale_x_discrete(labels=c("Control","Experimental")) + # X-tick labels
# scale_y_continuous(limits=c(315,460),breaks=c(320,390,460)) +
coord_fixed(ratio=0.015) +
theme_minimal(base_size=base_size) + # Background
theme(axis.title.x = element_text(size=rel(2), vjust=-1), # Label sizes, relative
axis.title.y = element_text(size=rel(2), vjust=2),
axis.text = element_text(size=rel(1.7)),
panel.grid.major.x = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.5),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
# Conversion to long format
data_REM_lat_long = dataframe_wide_to_long(data_sleep[2:30,c("ID","REM_lat_con","REM_lat_exp")]) # excluding participant 1, NA
# Plot
ggplot(data_REM_lat_long, aes(x=condition, y=value)) +
geom_violinhalf(aes(fill=condition), flip=1) + # Violin plot shape
geom_point(color="grey", size=2) + # Data points, jittered
geom_line(aes(group = ID), color="grey", linewidth=0.5) + # connect paired dots
stat_summary(fun = "mean", geom="point", shape=18, color = "black", size=5) + # Add mean as point
labs(title="REM Sleep Latency", x="Condition", y="Minutes") + # Labels
scale_fill_manual(values=c(colour_scheme$con, colour_scheme$exp), guide="none") + # Condition colours, remove legend
scale_x_discrete(labels=c("Control","Experimental")) + # X-tick labels
# scale_y_continuous(limits=c(315,460),breaks=c(320,390,460)) +
coord_fixed(ratio=0.015) +
theme_minimal(base_size=base_size) + # Background
theme(axis.title.x = element_text(size=rel(2), vjust=-1), # Label sizes, relative
axis.title.y = element_text(size=rel(2), vjust=2),
axis.text = element_text(size=rel(1.7)),
panel.grid.major.x = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.7),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
ggplot(data_REM_lat_long, aes(x=condition, y=value)) +
geom_violinhalf(aes(fill=condition), flip=1) + # Violin plot shape
geom_point(color="grey", size=2) + # Data points, jittered
geom_line(aes(group = ID), color="grey", linewidth=0.5) + # connect paired dots
stat_summary(fun = "mean", geom="point", shape=18, color = "black", size=5) + # Add mean as point
labs(title="REM Sleep Latency", x="Condition", y="Minutes") + # Labels
scale_fill_manual(values=c(colour_scheme$con, colour_scheme$exp), guide="none") + # Condition colours, remove legend
scale_x_discrete(labels=c("Control","Experimental")) + # X-tick labels
# scale_y_continuous(limits=c(315,460),breaks=c(320,390,460)) +
coord_fixed(ratio=0.015) +
theme_minimal(base_size=base_size) + # Background
theme(axis.title.x = element_text(size=rel(2), vjust=-1), # Label sizes, relative
axis.title.y = element_text(size=rel(2), vjust=2),
axis.text = element_text(size=rel(1.7)),
panel.grid.major.x = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.7),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
ggplot(medians_REMs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Rapid-Eye Movements", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=-0.2),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
ggplot(medians_spindles, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Spindles", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.08),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
ggplot(medians_SOs, aes(x=condition,y=variable,fill=value)) +
geom_tile(color = "white",lwd = 1.5) +
geom_text(aes(label=round(value, 2)), color = "white", size = 5, fontface="bold") +
scale_fill_gradient(low="grey", high="#6082B6") +
labs(title="Slow Oscillations", x="", y="") + # Labels
scale_x_discrete(labels=c("Control","Experimental")) + # x-axis tick labels
coord_fixed(ratio=1) +
theme_minimal(base_size = base_size) + # Background
theme(axis.text = element_text(size=rel(1.7)),
legend.position = 'none',
panel.grid = element_blank(),
plot.title = element_text(size=rel(3), hjust=0.6),
plot.margin = margin(0.5,0.5,0.5,0.5, "cm")) # Plot margins
